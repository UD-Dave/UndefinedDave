'use strict';

/* segment.io */
const config = require('./config');
const Analytics = require('analytics-node');

const analytics = new Analytics('sJOSIGKa5x5rJEGsaOlCjrgozAf7FnVY', { flushAt: 1 });

function identify(data) {
    if (config.IS_ON_PREM) {
        return;
    }
    analytics.identify(data);
}

function trackWithCIUser(eventName, properties) {
    return track('ci', eventName, properties);
}

function track(userId, eventName, properties) {
    if (config.IS_ON_PREM) {
        return;
    }
    analytics.track({
        userId,
        event: eventName,
        properties,
    });
}

module.exports = {
    identify,
    track,
    trackWithCIUser,
};
